Copy_Folder
/SIGNAL_TYPES=ANALOG
/EXISTING_FOLDER=ORIGINAL
/NEW_FOLDER_NAME=EMG ORIGINAL
! /OVERWRITE_EXISTING_SIGNALS=FALSE
;

Remove_Signals
/SIGNAL_TYPES=ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG+ANALOG
/SIGNAL_FOLDER=EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL+EMG ORIGINAL
/SIGNAL_NAMES=Trigno FSR Adapter 15: FSR 15.A+Trigno FSR Adapter 15: FSR 15.B+Trigno FSR Adapter 15: FSR 15.C+Trigno FSR Adapter 15: FSR 15.D+Trigno FSR Adapter 16: FSR 16.A+Trigno FSR Adapter 16: FSR 16.B+Trigno FSR Adapter 16: FSR 16.C+Trigno FSR Adapter 16: FSR 16.D+Trigno sensor 10: Acc 10.X+Trigno sensor 10: Acc 10.Y+Trigno sensor 10: Acc 10.Z+Trigno sensor 10: EMG 10+Trigno sensor 11: Acc 11.X+Trigno sensor 11: Acc 11.Y+Trigno sensor 11: Acc 11.Z+Trigno sensor 11: EMG 11+Trigno sensor 1: Acc 1.X+Trigno sensor 1: Acc 1.Y+Trigno sensor 1: Acc 1.Z+Trigno sensor 2: Acc 2.X+Trigno sensor 2: Acc 2.Y+Trigno sensor 2: Acc 2.Z+Trigno sensor 3: Acc 3.X+Trigno sensor 3: Acc 3.Y+Trigno sensor 3: Acc 3.Z+Trigno sensor 4: Acc 4.X+Trigno sensor 4: Acc 4.Y+Trigno sensor 4: Acc 4.Z+Trigno sensor 5: Acc 5.X+Trigno sensor 5: Acc 5.Y+Trigno sensor 5: Acc 5.Z+Trigno sensor 6: Acc 6.X+Trigno sensor 6: Acc 6.Y+Trigno sensor 6: Acc 6.Z+Trigno sensor 7: Acc 7.X+Trigno sensor 7: Acc 7.Y+Trigno sensor 7: Acc 7.Z+Trigno sensor 8: Acc 8.X+Trigno sensor 8: Acc 8.Y+Trigno sensor 8: Acc 8.Z+Trigno sensor 9: Acc 9.X+Trigno sensor 9: Acc 9.Y+Trigno sensor 9: Acc 9.Z
! /INCLUDE_MODELS=FALSE
;

Set_Pipeline_Parameter_To_List_Of_Signal_Names
/PARAMETER_NAME=SIGNAL_LIST_ORIGINAL
/SIGNAL_TYPES=ANALOG
/SIGNAL_FOLDER=EMG ORIGINAL
;

Set_Pipeline_Parameter
/PARAMETER_NAME=MODIFIED_ANALOG_NAMES
/PARAMETER_VALUE=::SIGNAL_LIST_ORIGINAL
/PARAMETER_VALUE_SEARCH_FOR=
/PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
! /MULTI_PASS=FALSE
;

Delete_Folder
/SIGNAL_TYPE=DERIVED
/FOLDER=ANALOG_ORIG
;

Multiply_Signals_By_Constant
/SIGNAL_TYPES=ANALOG
/SIGNAL_FOLDER=EMG ORIGINAL
! /SIGNAL_NAMES=::ORIGINAL_ANALOG_NAMES
! /SIGNAL_COMPONENTS=
/RESULT_TYPES=DERIVED
/RESULT_FOLDERS=ANALOG_ORIG
! /RESULT_NAME=
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=
/CONSTANT=1
;

Rename_Signals
! /FILE_NAME=
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=ANALOG_ORIG
/SIGNAL_NAMES=::ORIGINAL_ANALOG_NAMES
/NEW_SIGNAL_NAME=::MODIFIED_ANALOG_NAMES
! /APPEND_TO_OLD_SIGNAL_NAME=FALSE
! /INCLUDE_CALFILE=FALSE
;

!Subtracts Mean of Signal from Signal to correct DC offset
 !1)      Calculate Metric Mean of each EMG channel (in analog folder).
Metric_Mean
 /RESULT_METRIC_FOLDER=DCOFFSET
 /RESULT_METRIC_NAME=_ave
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_FOLDER=ANALOG_ORIG
 /SIGNAL_NAMES=::MODIFIED_ANALOG_NAMES
 /SIGNAL_COMPONENTS=
 /COMPONENT_SEQUENCE=X
 /EVENT_SEQUENCE=
 /EXCLUDE_EVENTS=
 /SEQUENCE_PERCENT_START=
 /SEQUENCE_PERCENT_END=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
;

! ---------------------------------------------------------------------------------
!  Take Means of Signals of all trials as first step to correct DC offset
! ---------------------------------------------------------------------------------

For_Each
/ITERATION_PARAMETER_NAME=SIG_CUR
/ITEMS=::MODIFIED_ANALOG_NAMES
;

! 2)      Subtract Mean from each channel (DC offset) so signals all fluctuate about 0 Volts.
Subtract_Signals
   /SIGNAL_TYPES=DERIVED+METRIC
   /SIGNAL_FOLDER=ANALOG_ORIG+DCOFFSET
   /SIGNAL_NAMES=&::SIG_CUR& + &::SIG_CUR&_ave
   ! /COMPONENT_SEQUENCE=
   /RESULT_FOLDER=DCOFFSET
   /RESULT_NAME=&::SIG_CUR&
;

End_For_Each
/ITERATION_PARAMETER_NAME=SIG_CUR
;

! 4-Option 2)       High Pass filter (20 Hz)
Highpass_Filter
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=DCOFFSET
/SIGNAL_NAMES=::MODIFIED_ANALOG_NAMES
/RESULT_FOLDER=HIGHPASS
! /RESULT_SUFFIX=
! /FILTER_CLASS=BUTTERWORTH
/FREQUENCY_CUTOFF=20
! /NUM_REFLECTED=6
! /NUM_EXTRAPOLATED=0
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

! 4-Option 2)       Low Pass filter (500 Hz) each rectified EMG signal (so I can compare to RMS method to see which I want to use)
Lowpass_Filter
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_FOLDER=HIGHPASS
 /SIGNAL_NAMES=::MODIFIED_ANALOG_NAMES
 /RESULT_FOLDER=LOWPASS
 ! /RESULT_SUFFIX=
 ! /FILTER_CLASS=BUTTERWORTH
 /FREQUENCY_CUTOFF=350
 ! /NUM_REFLECTED=6
 ! /NUM_EXTRAPOLATED=0
 ! /TOTAL_BUFFER_SIZE=6
 ! /NUM_BIDIRECTIONAL_PASSES=1
;

! ---------------------------------------------------------------------------------
!  Rectify, Bandpass, RMS
! ---------------------------------------------------------------------------------

! 3)      Rectify each  filtered_DC_offset EMG signal
Rectify
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_FOLDER=LOWPASS
 /SIGNAL_NAMES=::MODIFIED_ANALOG_NAMES
 ! /RESULT_TYPES=
 /RESULT_FOLDER=RECTIFIED
 ! /RESULT_NAMES=
 ! /RESULT_SUFFIX=
;

Set_Pipeline_Parameter
/PARAMETER_NAME= ANALOG_RATE
/PARAMETER_VALUE= 2000.000
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
! /MULTI_PASS=FALSE
;

!================================================================================================
!Before calculating RMS, make sure /NUM_WINDOW_FRAMES= 40ms for sampling rate used for collection
!i.e. = 2000Hz sampling rate, 2000*.04=80, must be odd number of frames = 81
!================================================================================================
! 4-Option 1)       Calculate RMS (40 ms window) EMG for each rectified EMG signal
Moving_RMS
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=RECTIFIED
/SIGNAL_NAMES=::MODIFIED_ANALOG_NAMES
! /RESULT_TYPES=
/RESULT_FOLDERS=RMS
! /RESULT_NAME=
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/NUM_WINDOW_FRAMES=81
;

Lowpass_Filter
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=RMS
! /SIGNAL_NAMES=
/RESULT_FOLDER=LOW_LOW
/RESULT_SUFFIX=_LOW_LOW
! /FILTER_CLASS=BUTTERWORTH
/FREQUENCY_CUTOFF=3
! /NUM_REFLECTED=6
! /NUM_EXTRAPOLATED=0
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

File_Save_As
! /FILE_NAME=
! /SET_PROMPT=Save CMO file as
! /SAVE_EMBEDDED_GRAPHICS=FALSE
;

